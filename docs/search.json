[
  {
    "objectID": "itm.html",
    "href": "itm.html",
    "title": "Inverse Transform Method (ITM)",
    "section": "",
    "text": "Two requirements to use the Inverse Transform Method (ITM) to generate from a random variable \\(X\\) with cdf \\(F_X(x)\\):\n\na uniform random number generator runif( )\nthe inverse cdf, \\(F^{−1}_X(p)\\)\n\n\n\n\n\n\n\nSteps\n\n\n\n\nCompute the inverse of \\(F_X(p):F^{−1}_X(p)\\)\nWrite an R function that computes \\(F^{−1}_X(p)\\)\nDraw \\(u \\sim U(0, 1)\\) and set \\(F^{−1}_X(u)\\)\n\n\n\n\nNote\n\nfor a discrete distribution computing the CDF is not difficult: add up the individual probabilities for the points of the distribution\nCDF for continuous dist. integrate the PDF\n\n\n\nExample: exponential dist\nStep 1: find the inverse \\(F_X(p)\\), the cdf is: \\(F_x = 1- exp(-\\lambda x)\\) for inverse solve:\n\\[\nF_x() = p  \\\\\nF_x() = 1- e^{(-\\lambda x)} = p \\\\\ne^{(-\\lambda x)} = 1 - p \\\\\nln(e^{(-\\lambda x)}) = ln(1-p) \\\\\n-\\lambda x = ln(1-p) \\\\\nx = - \\frac{1}{\\lambda} \\cdot ln(1-p)\n\\]\nStep 2 &3:\n\n\n\n\n\n\n\n\nFigure 4.1: Mean = r mean(x) and variance r var(x) E(X) if X~exp is 1/lam and var(x) should be 1/(lam^2)\n\n\n\n\n\n\n\nLecture 1: Exercise 2\n\nStep 1: pdf, cdf and expected value\nX ~ continuous random variable with density \\(f_X(x) = x^3\\) for 0&lt;=x&lt;=k\n\nfind k such that \\(f_X(x)\\) is a pdf\n\n\nintegrate the pdf\n\n\\[\n\\int_{0}^{k} x^3 dx \\\\\n\\left[ \\frac{x^4}{4} \\right]_0^k \\\\\n\\frac{k^4}{4}- 0 = 1 \\\\\nk^4 = 1*4 \\\\\nk = \\sqrt{2}\n\\]\n\nCompute the cdf FX(x)\n\nThe cdf is the integral of the pdf over it’s range\n\\[\nF_X(x)= \\int_{0}^{x} f_X(s) ds \\\\\n= \\int_{0}^{x} s^3 ds \\\\\n= \\frac{x^4}{4}, \\text{ when } 0&lt;=x&lt;=k = \\sqrt{2}   \\\\\n\\]\nTherefore the cdf is given by:\n\\[\nF_X(x) =\n\\begin{cases}\n0, & \\text{if  } x &lt; 0; \\\\\n\\frac{1}{4}x^4, & \\text{if  } 0 \\leq x \\leq \\sqrt{2}; \\\\\n1, & \\text{if  } x &gt; \\sqrt{2}.\n\\end{cases}\n\\]\n\nCompute E(X)\n\n\\[\nE(X) = \\int_{-\\infty}^{\\infty} x f_X(x) dx \\\\\nE(X) = \\int{0}^{k} x \\cdot x^3 dx = \\int{0}^{k} x^4 dx\\\\\nE(X) = \\left[ \\frac{x^5}{5} \\right]_0^k \\\\\nE(X) = \\left[ \\frac{x^5}{5} \\right]_0^{\\sqrt 2} \\\\\nE(X) = \\left[ \\frac{(\\sqrt 2)^5}{5} \\right] - 0 \\\\\nE(X) = \\frac{1}{5}(\\sqrt 2)^4 (\\sqrt 2) \\\\\nE(X) = \\frac{4}{5}(\\sqrt 2)\n\\]\n3.2 Compute Var(X) \\(Var(X) = E[X^2] -E[X]^2\\)\nStep 1\n\\[\nE(X^2) = \\int{0}^{k} x2\\cdot x3 dx \\\\\n= \\int{0}^{k} x^5 dx \\\\\n= \\left[ \\frac{x^6}{6} \\right]_0^k \\\\\n= \\left[ \\frac{(\\sqrt 2)^6}{6} \\right] - 0 \\\\\n= \\frac{8}{6} = \\frac{4}{3}\n\\]\nStep 2 \\([E(X)]^2 = (\\frac{4}{5}(\\sqrt 2))^2\\)\n\\[\nVar(X) = \\frac{4}{3} - (\\frac{4}{5}(\\sqrt 2))^2 = \\frac{4}{75}\n\\]\n\n\nStep 2: application of the ITM\nApply the ITM to generate (pseudo)-random numbers from this random variable:\nStep 1 Compute the inverse cdf \\(F^{−1}_X (x)\\)\nFor \\(0&lt;=x&lt;=k = \\sqrt{2}\\): cdf: \\(F_X^{-1}(x) = \\frac{x^4}{4}\\)\nSet \\(F_X^{-1}(x) = p\\) :\n\\[\n\\frac{x^4}{4} = p \\ x^4 = 4p \\ x = (4p)^{1/4} \\\\\nF_X^{-1}(p) = (4p)^{1/4}\n\\]\nand (b) write an R function to generate random numbers from X ∼ fX(x) that relies on the ITM.\n\n\nStep 3: double-check your random number generator\n\nCompare the range of the numbers generated at point (7) to the support of X. What do you notice?\n\n\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n 0.1127  0.9983  1.1889  1.1323  1.3166  1.4142 \n\n\nThe support of X is (\\(0, \\sqrt2\\)) but the range of the sample is (0.11, 1.4).\n\nCompute the mean and variance of the numbers generated at point (7), and compare them to the values of E(X) and V ar(X) that you computed at point (3). Are the numerical results in agreement with your analytical derivations?\n\n\n\n[1] 1.132304\n\n\n[1] 0.05234072\n\n\nanalytical:\n\n\n[1] 1.333333\n\n\n[1] 0.05333333\n\n\n\nDraw a histogram that shows the empirical density of the 10000 random numbers, and compare it to fX(x)\n\n\n\n\n\n\n\n\n\n\nThe values generated are close to the curve of \\(f_X(x)\\)\n\n\n\n(lecture 2) Discrete R.V.\n\nExample: binomial distribution\n\n\n [1] 3 4 4 3 5 5 3 1 2 2\n\n\n  omega     pmf rel.freq\n1     0 0.02799  0.02832\n2     1 0.13064  0.13305\n3     2 0.26127  0.25915\n4     3 0.29030  0.29070\n5     4 0.19354  0.19191\n6     5 0.07741  0.07758\n7     6 0.01720  0.01763\n8     7 0.00164  0.00166\n\n\n\nsample(1:k, n, replace = T, prob = c(…)) allows you to generate n independent realizations from a multinomial distribution\neach single draw from sample( ) as an application of the ITM\n\n\n\nExample\n\\(\\Omega = {1, 2, 3, 4}\\), \\(P(X = k) = \\frac{k}{10}\\) for \\(\\Omega \\in k\\)\n\npdf: \\(P(X = k) = \\frac{k}{10}\\) Where k can be 1,…4\ncdf is defined as \\(F_X(x) = P(X &lt;= k)\\) i.e. the sum of probabilities of all the outcomes of k.\n\n\\[\nF_X(x) =\n\\begin{cases}\n0                                         &  x &lt; 1; \\\\\n\\frac{1}{10}                              & 1 \\leq x \\leq{2}\n                                                \\text{ i.e.  }P(X=1); \\\\\n\\frac{1}{10}+\\frac{2}{10} = \\frac{3}{10}  & 2 \\leq x \\leq{3}; \\\\\n\\frac{6}{10}                              & 3 \\leq x \\leq{4}; \\\\\n1                                         &  x &lt;4; \\\\\n\\end{cases}\n\\]\n\nApplying ITM\n\nDraw from a U(0, 1)\n\nApply the inverse CDF to determine the outcome\n\nSuppose we generate u1 = 0.55 This u is in the interval of \\(\\frac{3}{10}\\leq x &lt; \\frac{6}{10}\\) The corresponding value of X for this interval is 3 Therefore \\(F_X^{-1}(0.55) =3\\)",
    "crumbs": [
      "Generating Random Numbers",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Inverse Transform Method (ITM)</span>"
    ]
  }
]